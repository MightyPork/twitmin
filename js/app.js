var twitmin=function(){function t(){var t=o.totalLen,e=0;o.fulltext="",o.tokens.forEach(function(t){if("word"==t.type){var n=_.isUndefined(t.altN)?0:t.altN;e+=t.options[n].length,o.fulltext+=t.options[n]}else e+=t.str.length,o.fulltext+=t.str}),$("#disp-len").text(e),$("#disp-abs").text(t-e),$("#disp-perc").text(Math.round((t-e)/t*1e3)/10),$("#disp-len").toggleClass("over",e>140)}function e(t){var e="_hiddenCopyText_";if(o=document.getElementById(e),!o){var o=document.createElement("textarea");o.style.position="absolute",o.style.left="-9999px",o.style.top="0",o.id=e,document.body.appendChild(o)}o.textContent=t;var n=document.activeElement;o.focus(),o.setSelectionRange(0,o.value.length);var i;try{i=document.execCommand("copy")}catch(a){i=!1}return n&&"function"==typeof n.focus&&n.focus(),o.textContent="",i}var o={};return o.init=function(){$(function(){function e(t){var e=$(t),o=t.selectionStart,n=e.val();e.val(n.substring(0,o)+"\n"+n.substring(o)),t.selectionStart=o+1,t.selectionEnd=o+1}function n(){$("#tweet-form").submit()}function i(t){$(".WordAlts").addClass("hidden"),$(t).find(".WordAlts").removeClass("hidden")}$("#tweet").on("keyup",function(t){10!=t.keyCode&&13!=t.keyCode||!t.ctrlKey&&!t.metaKey||e(this)}).on("keydown",function(t){return 10!=t.keyCode&&13!=t.keyCode||t.ctrlKey||t.metaKey?void 0:(n(),t.preventDefault(),t.stopImmediatePropagation(),!1)}),$(".WordAlts").on("mouseenter",function(){clearTimeout($(this).closest(".Word").data("altTmeoHide")),clearTimeout($(this).closest(".Word").data("altTmeoHide2"))}).on("mouseleave",function(){var t=this,e=setTimeout(function(){$(t).addClass("hidden")},500);$(this).closest(".Word").data("altTmeoHide2",e)}),$(".Word").on("mouseenter",function(){var t=this,e=$(t).find(".WordAlts");if(clearTimeout($(this).data("altTmeoHide")),clearTimeout($(this).data("altTmeoHide2")),e.hasClass("hidden")){var o=setTimeout(function(){i(t)},250);$(this).data("altTmeoShow",o)}}).on("mouseleave",function(){clearTimeout($(this).data("altTmeoShow"));var t=this,e=$(t).find(".WordAlts");if(!e.hasClass("hidden")){var o=setTimeout(function(){e.addClass("hidden")},500);$(this).data("altTmeoHide",o)}}),$(".WordAlt").on("click",function(){var e=$(this).closest(".Word"),n=$(this).data("alt_n"),i=e.data("tok_n");e.find(".WVal").text(o.tokens[i].options[n]),o.tokens[i].altN=n,$(".WordAlts").addClass("hidden"),t()})}),$("#copy-btn").on("click",function(){e(o.fulltext)}),$("#tweet-btn").on("click",function(){location.href="https://twitter.com/intent/tweet?text="+encodeURIComponent(o.fulltext)}),twitmin.tokens&&t()},o}();